@model IEnumerable<VanriseInternship_KawtharHijazi.Models.Device>

@{
    ViewBag.Title = "DeviceView";
}

<!DOCTYPE html>
<html ng-app="devicesApp">
<head>
    <title>Devices Page From Database</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.8/angular.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular-ui-bootstrap/0.14.3/ui-bootstrap-tpls.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="~/Scripts/MyScripts/Device.js"></script>

</head>
<body ng-controller="DeviceController">
    <div class="container">
        <h2>Devices</h2>
        <div class="form-group">
            <input type="text" ng-model="searchText" class="form-control" placeholder="Search ...">
            <button class="btn btn-primary" ng-click="searchDevices()">Search</button>
            <button class="btn btn-success" ng-click="openAddModal()">Add</button>
        </div>
        <table class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="device in filteredDevices">
                    <td>{{ device.ID }}</td>
                    <td>{{ device.Name }}</td>
                    <td>
                        <button class="btn btn-info btn-sm" ng-click="openEditModal(device)">Edit</button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Add/Edit Modal -->
    <script type="text/ng-template" id="addEditModal.html">
        <div class="modal-header">
            <h3 class="modal-title" id="modal-title">{{ modalTitle }}</h3>
        </div>
        <div class="modal-body" id="modal-body">
            <form name="myForm">
                <div class="form-group" ng-class="{'has-error': myForm.deviceName.$invalid && myForm.deviceName.$touched}">
                    <label for="deviceName">Name</label>
                    <input type="text" class="form-control" id="deviceName" name="deviceName" ng-model="modalDevice.Name" required>

                    <div class="help-block" ng-if="myForm.deviceName.$invalid && myForm.deviceName.$touched" style="color: red;">
                      Device Name is required.
                    </div>
                </div>
            </form>

            <div class="alert alert-danger" ng-show="errorMessage">{{ errorMessage }}</div>
            <div class="alert alert-success" ng-show="successMessage">{{ successMessage }}</div>

        </div>
        <div class="modal-footer">
            <button class="btn btn-primary" type="button" ng-click="saveDevice()" ng-disabled="myForm.$invalid">Save</button>
            <button class="btn btn-secondary" type="button" ng-click="cancel()">Cancel</button>
        </div>
    </script>

    </body>
</html>